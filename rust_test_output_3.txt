    Blocking waiting for file lock on build directory
   Compiling cosyvoice-native-server v0.1.0 (/home/grant/github/CosyVoice-1/rust/native-server)
warning: function `normalize_punctuation` is never used
   --> native-server/src/text_frontend.rs:125:4
    |
125 | fn normalize_punctuation(text: &str) -> String {
    |    ^^^^^^^^^^^^^^^^^^^^^
    |
    = note: `#[warn(dead_code)]` (part of `#[warn(unused)]`) on by default

warning: fields `center` and `device` are never read
   --> native-server/src/utils.rs:123:5
    |
119 | pub struct InverseStftModule {
    |            ----------------- fields in this struct
...
123 |     center: bool,
    |     ^^^^^^
124 |     device: Device,
    |     ^^^^^^

warning: `cosyvoice-native-server` (lib) generated 2 warnings
warning: unused variable: `llm_path`
   --> native-server/src/bin/test_llm_parity.rs:107:9
    |
107 |     let llm_path = model_dir.join("llm.safetensors"); // Or just passing the directory? VarBuilder needs a file or list of files.
    |         ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_llm_path`
    |
    = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: `cosyvoice-native-server` (bin "test_llm_parity") generated 1 warning (run `cargo fix --bin "test_llm_parity" -p cosyvoice-native-server` to apply 1 suggestion)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 19.76s
     Running `rust/target/debug/test_llm_parity`
Using device: Cuda(CudaDevice(DeviceId(1)))
Loading debug data from "/home/grant/github/CosyVoice-1/rust/native-server/../../debug_llm_data.safetensors"
  input_text_embeds: shape=[1, 7, 896], min=-0.219238, max=0.118286, mean=0.000075
  input_prompt_tokens: shape=[1, 50], min=2.000000, max=98.000000, mean=48.400002
Loading CosyVoice LLM...
Running debug_forward_one...
LLM: Using speech special token sos=6561 (norm: 790.4866)
LLM: Using speech special token task_id=6563 (norm: 709.7413)
  debug_forward_one: lm_input shape=[1, 59, 896], mean=-0.004828762
  debug_forward_one: y_pred shape=[1, 59, 896], mean=0.018898292
  rust_logits: shape=[1, 1, 6761], min=-10.632812, max=9.429688, mean=-1.603182
  py_logits: shape=[1, 1, 6761], min=-12.601562, max=12.234375, mean=-2.150717
  LLM Logits: max_diff=7.628906, mean_diff=1.855576
  WARNING: Large divergence in LLM Logits!
